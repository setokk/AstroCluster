<div class="title-container">
    @if (chartDataPPC.length > 0) {
        <h2>Result for analysis {{ getAnalysisResponse!.analysisData.projectUUID }}</h2>
        <h3>Currently showing: <a style="user-select: none;">{{ activeChartTitle }}</a></h3>
    } @else {
        <h2></h2>
        <h3></h3>
    }
</div>

@if (chartDataPPC.length > 0) {
    <div class="flex-row-container">
        <!-- Left aligned content. Charts placement -->
        <div class="left-aligned-content">
            @if (activeChartTitle === 'Percentage per Cluster') {
                <ngx-charts-bar-horizontal
                        [view]="[900, 400]"
                        [results]="chartDataPPC"
                        [scheme]="colorSchemePPC"
                        [gradient]="false"
                        [xAxis]="true"
                        [yAxis]="true"
                        [legend]="true"
                        [showXAxisLabel]="true"
                        [xAxisLabel]="'Percentage (%)'"
                        [showYAxisLabel]="true"
                        [yAxisLabel]="'Cluster Labels'">
                </ngx-charts-bar-horizontal>
            } @else if (activeChartTitle === 'Cluster File Results') {
                <ngx-graph
                        class="chart-container"
                        [view]="[graphWidth, graphHeight]"
                        [nodes]="nodesFCL"
                        [links]="[]"
                        [layoutSettings]="{orientation: 'TB', marginX: 25, marginY: 25}">
                    <!-- Node Template -->
                    <ng-template #nodeTemplate let-node>
                        <svg:g>
                            <svg:circle
                                    r="15"
                                    [attr.fill]="node.data.customColor"
                                    stroke="white"
                                    stroke-width="1">
                            </svg:circle>
                            <svg:text
                                    text-anchor="middle"
                                    y="5"
                                    font-size="10"
                                    fill="white">
                                {{ node.label }}
                            </svg:text>
                        </svg:g>
                    </ng-template>

                    <!-- Cluster Template -->
                    <ng-template #clusterTemplate let-cluster>
                        <svg:g>
                            <svg:rect
                                    x="-20" y="-20"
                                    width="40" height="40"
                                    [attr.fill]="cluster.data.customColor"
                                    stroke="white"
                                    stroke-width="2">
                            </svg:rect>
                            <svg:text
                                    text-anchor="middle"
                                    font-size="12"
                                    fill="white">
                                {{ cluster.label }}
                            </svg:text>
                        </svg:g>
                    </ng-template>
                </ngx-graph>
            }
        </div>

        <!-- Right aligned content. Specific options based on chart -->
        <div class="right-aligned-content">
            @if (activeChartTitle === 'Percentage per Cluster') {
                <label for="topClustersRange">Top K Clusters:</label>
                <input type="range"
                       min="1" max="{{ chartDataPPC.length }}" step="1"
                       [(ngModel)]="topClustersValue"
                       name="topClustersRange" id="topClustersRange"/>
                <label for="lastClustersRange">Last N Clusters:</label>
                <input type="range"
                       min="0" max="{{ chartDataPPC.length }}" step="1"
                       [(ngModel)]="lastClusterValue"
                       name="lastClustersRange" id="lastClustersRange"/>
                <button>Reset</button>
            }
            <h3>Interest PDF generation:</h3>
        </div>
    </div>
}